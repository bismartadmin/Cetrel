--Insere o frete no cadastro do Fornecedor do Material de Compra
BEGIN
    INSERT INTO PURCH_CHARGE_PART_SUPPLIER_TAB (
        VENDOR_NO, CONTRACT, PART_NO, CHARGE_TYPE,
        CHARGE_BY_SUPPLIER, CHARGED_QTY, CHARGE_AMOUNT, CHARGE_AMOUNT_INCL_TAX,
        PRINT_PURCHASE_CHARGE, UNIT_CHARGE, INTRASTAT_EXEMPT, DISTRIBUTE_ON_RECEIPT,
        ROWVERSION, ROWKEY, SEQ_NO
    )
    SELECT
        '&NEW:VENDOR_NO', '&NEW:CONTRACT', '&NEW:PART_NO', CT.CHARGE_TYPE,
        '&NEW:VENDOR_NO', 1, 0, 0,
        'PRINT', 'FALSE', 'FALSE', 'TRUE',
        SYSDATE, SYS_GUID(),
        (
        SELECT NVL(MAX(SEQ_NO)+1,1)
          FROM PURCH_CHARGE_PART_SUPPLIER_TAB
         WHERE VENDOR_NO = '&NEW:VENDOR_NO'
           AND CONTRACT = '&NEW:CONTRACT'
           AND PART_NO = '&NEW:PART_NO'
           AND CHARGE_TYPE = CT.CHARGE_TYPE
        )
    FROM PURCHASE_CHARGE_TYPE_TAB CT
    LEFT JOIN PURCH_CHARGE_PART_SUPPLIER_TAB PC
        ON PC.VENDOR_NO = '&NEW:VENDOR_NO'
        AND PC.CONTRACT = '&NEW:CONTRACT'
        AND PC.PART_NO = '&NEW:PART_NO'
        AND PC.CHARGE_TYPE = CT.CHARGE_TYPE
    WHERE PC.VENDOR_NO IS NULL
    AND CT.CONTRACT = '&NEW:CONTRACT'
    AND CT.CHARGE_TYPE IN ('FRETE');
END;
